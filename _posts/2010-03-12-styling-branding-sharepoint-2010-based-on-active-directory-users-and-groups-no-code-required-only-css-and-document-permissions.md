---
ID: 1121
post_title: >
  Styling, branding SharePoint 2010 based
  on Active Directory users and groups, no
  code required, only CSS and Document
  Permissions
author: Roel van Lisdonk
post_excerpt: ""
layout: post
permalink: >
  https://www.roelvanlisdonk.nl/2010/03/12/styling-branding-sharepoint-2010-based-on-active-directory-users-and-groups-no-code-required-only-css-and-document-permissions/
published: true
post_date: 2010-03-12 08:15:08
---
<p>To style a SharePoint 2010 site, based on the current user and his active directory role, I use document permissions on css files in the Style Library.</p>  <p>The goal of the blog post is to Show a a logo of a man, when the current user is member of the Active Directory role [Men] and show a logo of a Woman, when the current user is member of the Active Directory role [Women].</p>  <p>&#160;</p>  <p><strong>Woman (Elise) signs in</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image10.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb10.png" width="804" height="551" /></a> </p>  <p>&#160;</p>  <p><strong>Men (Bas) signs in</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image11.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb11.png" width="804" height="554" /></a> </p>  <p>&#160;</p>  <p><strong>Guide</strong></p>  <ul>   <li>In Active Directory create two roles: [Men] and Women</li>    <li>In Active Directory create the users [Bas] and make him member of the role [Men]</li>    <li>In Active Directory create the users [Elise] and make her member of the role [Women]</li>    <li>In SharePoint 2010 go to Site Actions &gt; Site Permission on you’re site collection top level site</li>    <li>Grant Permissions [Full Control] to the Active Directory groups: [Men] and [Women]</li> </ul>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image12.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb12.png" width="804" height="551" /></a> </p>  <ul>   <li>Create two css files on you’re desktop: Men.css and Women.css</li>    <li>Men.css contains:</li> </ul>  <p>.logo   <br />{    <br />&#160;&#160;&#160; background-image:url(&quot;/Style%20Library/Images/Men.png&quot;);    <br />&#160;&#160;&#160; background-repeat: no-repeat;    <br />&#160;&#160;&#160; background-position: top left;    <br />&#160;&#160;&#160; height: 425px;    <br />}</p>  <ul>   <li>Women.css cotains: </li> </ul>  <p>.logo    <br />{    <br />&#160;&#160;&#160; background-image:url(&quot;/Style%20Library/Images/Women.png&quot;);    <br />&#160;&#160;&#160; background-repeat: no-repeat;    <br />&#160;&#160;&#160; background-position: top left;    <br />&#160;&#160;&#160; height: 425px;    <br />}</p>  <p>&#160;</p>  <ul>   <li>Go to you’re SharePoint top level site, click on Site Actions &gt; Site Settings</li> </ul>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image13.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb13.png" width="704" height="514" /></a> </p>  <ul>   <li>Site Administration &gt; Content and structure</li> </ul>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image14.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb14.png" width="704" height="514" /></a> </p>  <ul>   <li>Upload Women.png and Men.png to the Style Library\Images by dragging and dropping the files (New &gt; Item &gt; Upload Multiple Files…) </li>    <li>Create Images folder if it does not exist in the [Style Library]</li> </ul>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image15.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb15.png" width="704" height="517" /></a> </p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image16.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb16.png" width="704" height="412" /></a> </p>  <ul>   <li>After upload check the files in</li> </ul>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image17.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb17.png" width="704" height="506" /></a> </p>  <ul>   <li>Upload Men.css and Women.css to the Style Library and check in files</li>    <li>Manage permissions on Men.css to include only men (click on Manage Permissions &gt; Stop inherriting permissions), remove user permissions for women</li>    <li>Manage permissions on Women.css to include only women(click on Manage Permissions &gt; Stop inherriting permissions), remove user permissions for men</li> </ul>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image18.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb18.png" width="704" height="625" /></a> </p>  <ul>   <li>Open Microsoft SharePoint Designer and open you’re site then click on Master Pages &gt; v4.master</li>    <li>Click on Attach Style Sheet, browse for the Men.css stylesheet and click on Import &gt; OK</li>    <li>Repeat for Women.css</li>    <li>The only thing what this does, is adding the following lines at the end of the &lt;head&gt; tag in the master page</li> </ul>  <p>@import url('../../Style%20Library/Men.css');   <br />@import url('../../Style%20Library/Women.css'); </p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image19.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb19.png" width="704" height="579" /></a> </p>  <ul>   <li>Make sure all persons have read rights on the Master Page Gallery and the v4.master is checked in after you edit the file to import Men.css and Women.css</li> </ul>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image20.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb20.png" width="704" height="514" /></a>&#160;</p>  <ul>   <li>On you’re team site, click in the ribbon on Page &gt; Edit</li> </ul>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image21.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb21.png" width="704" height="459" /></a> </p>  <ul>   <li>Click in the ribbon on Format Text &gt; HTML &gt; Edit HTML Source</li>    <li>Add &lt;div class=”logo”&gt;&lt;/div&gt; to the content editor webpart</li> </ul>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image22.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2010/03/image_thumb22.png" width="704" height="459" /></a> </p>  <ul>   <li>Click on OK then in the ribbon on Save</li> </ul>  <p>&#160;</p>  <p>Result, see beginning of this blog post</p>