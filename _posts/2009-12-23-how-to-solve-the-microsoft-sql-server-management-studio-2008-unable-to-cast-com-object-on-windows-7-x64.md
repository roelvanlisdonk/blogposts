---
ID: 872
post_title: 'How to solve the Microsoft SQL Server Management Studio 2008 Unable to cast COM object&#8230; on Windows 7 x64'
author: Roel van Lisdonk
post_excerpt: ""
layout: post
permalink: >
  https://www.roelvanlisdonk.nl/2009/12/23/how-to-solve-the-microsoft-sql-server-management-studio-2008-unable-to-cast-com-object-on-windows-7-x64/
published: true
post_date: 2009-12-23 10:33:36
---
<p>When you open Microsoft SQL Server Management Studio 2008 on Windows 7 x64 and connect to a database instance, you get the error:   <br />    <br />SSMS - Unable to cast COM object of type 'System.__ComObject' to interface type 'Microsoft.VisualStudio.OLE.Interop.IServiceProvider'. This operation failed because the QueryInterface call on the COM component for the interface with IID '{6D5140C1-7436-11CE-8034-00AA006009FA}' failed due to the following error: No such interface supported (Exception from HRESULT: 0x80004002 (E_NOINTERFACE)). (Microsoft.VisualStudio.OLE.Interop)    <br />    <br />    <br /><strong>The problem is not the Microsoft SQL Server Management Studio 2008, but IE 8 on Windows 7, try:</strong></p>  <p>The solution posted on: <a title="http://social.answers.microsoft.com/Forums/en-US/InternetExplorer/thread/e312e580-1cbc-496b-8c6b-b69b8535a7bb" href="http://social.answers.microsoft.com/Forums/en-US/InternetExplorer/thread/e312e580-1cbc-496b-8c6b-b69b8535a7bb">http://social.answers.microsoft.com/Forums/en-US/InternetExplorer/thread/e312e580-1cbc-496b-8c6b-b69b8535a7bb</a> solved my problem    <br />    <br />For Win 7 64 bits :    <br />1 - Create a new notepad document and paste this text :    <br /><em>@echo off     <br />echo.      <br />echo IEREREG Version 1.07 for IE8 27.03.2009      <br />echo by Kai Schaetzl </em><a href="http://iefaq.info"><em>http://iefaq.info</em></a>    <br /><em>echo installs and registers (if suitable) all DLLs known to be used by IE8.     <br />echo should only take a few seconds, but please be patient      <br />echo.      <br />REM ******************************      <br />echo registering IE files      <br />REM IE files (= part of setup)      <br />regsvr32 /s /i browseui.dll      <br />REM regsvr32 /s /i browseui.dll,NI (unnecessary)      <br />regsvr32 /s corpol.dll      <br />regsvr32 /s dxtmsft.dll      <br />regsvr32 /s dxtrans.dll      <br />REM simple HTML Mail API      <br />regsvr32 /s &quot;%ProgramFiles(x86)%\internet explorer\hmmapi.dll&quot;      <br />REM group policy snap-in      <br />regsvr32 /s ieaksie.dll      <br />REM smart screen      <br />regsvr32 /s ieapfltr.dll      <br />REM ieak branding      <br />regsvr32 /s iedkcs32.dll      <br />REM dev tools      <br />regsvr32 /s &quot;%ProgramFiles(x86)%\internet explorer\iedvtool.dll&quot;      <br />regsvr32 /s iepeers.dll      <br />REM Symptom: IE8 closes immediately on launch, missing from IE7      <br />regsvr32 /s &quot;%ProgramFiles(x86)%\internet explorer\ieproxy.dll&quot;      <br />REM no install point anymore      <br />REM regsvr32 /s /i iesetup.dll      <br />REM no reg point anymore      <br />REM regsvr32 /s imgutil.dll      <br />regsvr32 /s /i /n inetcpl.cpl      <br />REM no install point anymore      <br />REM regsvr32 /s /i inseng.dll      <br />regsvr32 /s jscript.dll      <br />REM license manager      <br />regsvr32 /s licmgr10.dll      <br />REM regsvr32 /s msapsspc.dll      <br />REM regsvr32 /s mshta.exe      <br />REM VS debugger      <br />regsvr32 /s msdbg2.dll      <br />REM no install point anymore      <br />REM regsvr32 /s /i mshtml.dll      <br />regsvr32 /s mshtmled.dll      <br />regsvr32 /s msident.dll      <br />REM no reg point anymore      <br />REM regsvr32 /s msrating.dll      <br />REM multimedia timer      <br />regsvr32 /s mstime.dll      <br />REM no install point anymore      <br />REM regsvr32 /s /i occache.dll      <br />REM process debug manager      <br />regsvr32 /s &quot;%ProgramFiles(x86)%\internet explorer\pdm.dll&quot;      <br />REM no reg point anymore      <br />REM regsvr32 /s pngfilt.dll      <br />REM regsvr32 /s /i setupwbv.dll (not there anymore!)      <br />regsvr32 /s tdc.ocx      <br />regsvr32 /s /i urlmon.dll      <br />REM regsvr32 /s /i urlmon.dll,NI,HKLM      <br />regsvr32 /s vbscript.dll      <br />REM VML renderer      <br />regsvr32 /s &quot;%CommonProgramFiles%\microsoft shared\vgx\vgx.dll&quot;      <br />REM no install point anymore      <br />REM regsvr32 /s /i webcheck.dll      <br />regsvr32 /s /i /n wininet.dll      <br />REM ******************************      <br />echo registering system files      <br />REM additional system dlls known to be used by IE      <br />REM added 11.05.2006 Symptom: Add-Ons-Manager menu entry is present but nothing happens      <br />regsvr32 /s extmgr.dll      <br />REM added 12.05.2006 Symptom: Javascript links don't work (Robin Walker) .NET hub file      <br />regsvr32 /s mscoree.dll      <br />REM added 23.03.2009 Symptom: Find on this page is blank      <br />regsvr32 /s oleacc.dll      <br />REM added 24.03.2009 Symptom: Printing problems, open in new window      <br />regsvr32 /s ole32.dll      <br />REM mscorier.dll      <br />REM mscories.dll      <br />REM Symptom: open in new tab/window not working      <br />regsvr32 /s actxprxy.dll      <br />regsvr32 /s asctrls.ocx      <br />regsvr32 /s cdfview.dll      <br />regsvr32 /s comcat.dll      <br />regsvr32 /s /i /n comctl32.dll      <br />regsvr32 /s cryptdlg.dll      <br />regsvr32 /s /i /n digest.dll      <br />regsvr32 /s dispex.dll      <br />regsvr32 /s hlink.dll      <br />regsvr32 /s mlang.dll      <br />regsvr32 /s mobsync.dll      <br />regsvr32 /s /i msieftp.dll      <br />REM regsvr32 /s msnsspc.dll #no entry point      <br />regsvr32 /s msr2c.dll      <br />regsvr32 /s msxml.dll      <br />regsvr32 /s oleaut32.dll      <br />REM regsvr32 /s plugin.ocx #no entry point      <br />regsvr32 /s proctexe.ocx      <br />REM plus DllRegisterServerEx ExA ExW ... ?      <br />regsvr32 /s /i scrobj.dll      <br />REM shdocvw.dll hasn't been updated for IE7 and IE8, it still registers itself for the Windows Internet Controls      <br />regsvr32 /s /i shdocvw.dll      <br />regsvr32 /s sendmail.dll      <br />REM ******************************      <br />REM PKI/crypto functionality      <br />REM initpki can take very long to run and is rarely a problem      <br />REM if there are problems with crypto, SSL, certificates      <br />REM remove the three following REMs from the lines      <br />REM echo We are almost done except one crypto file      <br />REM echo but this will take very long, be patient!      <br />REM regsvr32 /s /i:A initpki.dll      <br />REM ******************************      <br />REM tabbed browser, do at the end, why originally with /n ?      <br />regsvr32 /s /i ieframe.dll      <br />REM ******************************      <br />echo correcting bugs in the registry      <br />REM do some corrective work      <br />REM Symptom: new tabs page cannot display content because it cannot access the controls (added 27. 3.2009)      <br />REM This is a result of a bug in shdocvw.dll (see above), probably only on Windows XP      <br />reg add &quot;HKCR\TypeLib\{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}\1.1\0\win32&quot; /ve /t REG_SZ /d %systemroot%\system32\ieframe.dll /f      <br />REM ******************************      <br />echo all tasks have been finished      <br />echo.      <br />pause      <br /></em>2 - Close all your IE windows and processes.    <br />3 - Save your document on your Desktop by example, with the .bat extension. Right-click on it, and select &quot;Run as administrator&quot;.    <br />4 - Test if this tip resolved your issue by openning IE. If you use a Windows 32 bits version, please replace <em>%ProgramFiles(x86)%</em> by <em>%ProgramFiles%</em> in your .bat file.</p>