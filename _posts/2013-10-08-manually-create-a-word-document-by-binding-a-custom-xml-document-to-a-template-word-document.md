---
ID: 3487
post_title: >
  Manually create a Word document by
  binding a custom xml document to a
  template Word document
author: Roel van Lisdonk
post_excerpt: ""
layout: post
permalink: >
  https://www.roelvanlisdonk.nl/2013/10/08/manually-create-a-word-document-by-binding-a-custom-xml-document-to-a-template-word-document/
published: true
post_date: 2013-10-08 09:12:37
---
<p>This post describes how you can create a Microsoft Office Word (2007/2010/2013) document by merging a Word template and a custom xml document.</p>  <p>&#160;</p>  <p>Note: This post uses Microsoft Office Word 2013, but the same applies to Microsoft Office Word 2007 and 2010. </p>  <p>&#160;</p>  <p>&#160;</p>  <p><strong>Open Microsoft Office Word 2013 open the developer tab on the ribbon</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image001.png" rel="lightbox"><img title="clip_image001" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image001" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image001_thumb.png" width="244" height="46" /></a></p>  <p>&#160;</p>  <p>&#160;</p>  <p><strong>If the developer tab is not visible, go to File &gt; Options</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image002.png" rel="lightbox"><img title="clip_image002" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image002" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image002_thumb.png" width="230" height="244" /></a></p>  <p>&#160;</p>  <p><strong>Go to Customize Ribbon &gt; Enable &quot;Developer&quot; tab</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image003.png" rel="lightbox"><img title="clip_image003" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image003" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image003_thumb.png" width="244" height="199" /></a></p>  <p>&#160;</p>  <p><strong>First insert some text, a table and an image to give the template some body.</strong></p>  <p>Now insert a Plain Text Content Control</p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image004.png" rel="lightbox"><img title="clip_image004" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image004" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image004_thumb.png" width="244" height="158" /></a></p>  <p>&#160;</p>  <p><strong>Click on Properties and enter as: </strong></p>  <p>Title: &quot;CustomerName&quot;</p>  <p>Tag: &quot;CustomerName&quot;</p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image005.png" rel="lightbox"><img title="clip_image005" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image005" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image005_thumb.png" width="244" height="119" /></a></p>  <p>&#160;</p>  <p><strong>Save the document to &quot;C:\Temp\CustomerInfo.docx&quot; and close Microsoft Office Word</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image006.png" rel="lightbox"><img title="clip_image006" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image006" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image006_thumb.png" width="244" height="118" /></a></p>  <p>&#160;</p>  <p><strong>Rename the file to &quot;C:\Temp\CustomerInfo.zip&quot;</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image007.png" rel="lightbox"><img title="clip_image007" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image007" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image007_thumb.png" width="244" height="108" /></a></p>  <p>&#160;</p>  <p>&#160;</p>  <p><strong>Extract the file to &quot;C:\Temp\CustomerInfo&quot;</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image008.png" rel="lightbox"><img title="clip_image008" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image008" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image008_thumb.png" width="244" height="100" /></a></p>  <p>&#160;</p>  <p>&#160;</p>  <p><strong>Add the folder &quot;C:\Temp\CustomerInfo\customXml&quot;</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image009.png" rel="lightbox"><img title="clip_image009" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image009" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image009_thumb.png" width="244" height="104" /></a></p>  <p>&#160;</p>  <p>&#160;</p>  <p align="left"><strong>Create the files item1.xml and itemProps1.xml and the folder _rels in the folder &quot;C:\Temp\CustomerInfo\customXml&quot;</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image010.png" rel="lightbox"><img title="clip_image010" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image010" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image010_thumb.png" width="244" height="63" /></a></p>  <p>item1.xml</p>  <p>&lt;root&gt;</p>  <p>&lt;customer&gt;</p>  <p>&lt;name&gt;Customer 1&lt;/name&gt;</p>  <p>&lt;/customer&gt;</p>  <p>&lt;/root&gt;</p>  <p>&#160;</p>  <p>&#160;</p>  <p><strong>itemProps1.xml</strong></p>  <p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;</p>  <p>&lt;ds:datastoreItem ds:itemID=&quot;{8f93798d-1506-45f2-811e-70f72165a32d}&quot; xmlns:ds=&quot;http://schemas.openxmlformats.org/officeDocument/2006/customXml&quot; /&gt;</p>  <p>The itemID is just a GUID.</p>  <p>&#160;</p>  <p>&#160;</p>  <p><strong>You can create a new GUID with Microsoft Visual Studio:</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image011.png" rel="lightbox"><img title="clip_image011" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image011" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image011_thumb.png" width="191" height="244" /></a></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image012.png" rel="lightbox"><img title="clip_image012" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image012" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image012_thumb.png" width="236" height="244" /></a></p>  <p>&#160;</p>  <p><strong>Create a file item1.xml.rels in the folder &quot;C:\Temp\CustomerInfo\customXml\_rels&quot;</strong></p>  <p align="left">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</p>  <p align="left">&lt;Relationships xmlns=&quot;http://schemas.openxmlformats.org/package/2006/relationships&quot;&gt;</p>  <p align="left">&lt;Relationship Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps&quot; Target=&quot;/customXml/itemProps1.xml&quot; Id=&quot;Rb8d5386a2f8640f88dad1eff30868bcf&quot; /&gt;</p>  <p align="left">&lt;/Relationships&gt;</p>  <p align="left">The Id is just a GUID without &quot;-&quot;.</p>  <p align="left">Edit the file &quot;C:\Temp\CustomerInfo\word\_rels\document.xml.rels&quot;</p>  <p align="left">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</p>  <p align="left">&lt;Relationships xmlns=&quot;http://schemas.openxmlformats.org/package/2006/relationships&quot;&gt;</p>  <p align="left">&lt;Relationship Id=&quot;rId3&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings&quot; Target=&quot;webSettings.xml&quot;/&gt;</p>  <p align="left">&lt;Relationship Id=&quot;rId7&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme&quot; Target=&quot;theme/theme1.xml&quot;/&gt;</p>  <p align="left">&lt;Relationship Id=&quot;rId2&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings&quot; Target=&quot;settings.xml&quot;/&gt;</p>  <p align="left">&lt;Relationship Id=&quot;rId1&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles&quot; Target=&quot;styles.xml&quot;/&gt;</p>  <p align="left">&lt;Relationship Id=&quot;rId6&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/glossaryDocument&quot; Target=&quot;glossary/document.xml&quot;/&gt;</p>  <p align="left">&lt;Relationship Id=&quot;rId5&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable&quot; Target=&quot;fontTable.xml&quot;/&gt;&lt;Relationship Id=&quot;rId4&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/image&quot; Target=&quot;media/image1.jpeg&quot;/&gt;</p>  <p align="left">&lt;Relationship Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml&quot; Target=&quot;../customXml/item1.xml&quot; Id=&quot;Rdfc14bfb0c244ab3&quot; /&gt;</p>  <p align="left">&lt;/Relationships&gt;</p>  <p>The ID is a GUID without &quot;-&quot;.</p>  <p>&#160;</p>  <p><strong>Edit the file &quot;C:\Temp\CustomerInfo\word\document.xml&quot;</strong></p>  <p>Search for &quot;CustomerName&quot; in the file.</p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image013.png" rel="lightbox"><img title="clip_image013" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image013" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image013_thumb.png" width="244" height="89" /></a></p>  <p>Add &lt;w:dataBinding w:xpath=&quot;/root/customer[1]/name[1]&quot; w:storeItemID=&quot;{8f93798d-1506-45f2-811e-70f72165a32d}&quot; /&gt;</p>  <p>just after the &lt;w:sdtPr&gt; containing the CustomerName content control.</p>  <p>&#160;</p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image014.png" rel="lightbox"><img title="clip_image014" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image014" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image014_thumb.png" width="244" height="34" /></a></p>  <p>&#160;</p>  <p>&#160;</p>  <p><strong>Edit the file &quot;C:\Temp\CustomerInfo\[Content_Types].xml&quot;</strong></p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image015.png" rel="lightbox"><img title="clip_image015" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image015" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image015_thumb.png" width="244" height="39" /></a></p>  <p>Now when you zip the contents of the folder &quot;C:\Temp\CustomerInfo&quot; and rename the zip to CustomerInfo2.docx, the CustomerName content control should be automatically filled with the text &quot;Customer 1&quot; from the item1.xml file.</p>  <p>When zipping make sure, you zip the contents of the folder en not the folder itself:</p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image016.png" rel="lightbox"><img title="clip_image016" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px 5px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="clip_image016" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2013/10/clip_image016_thumb.png" width="244" height="182" /></a></p>  <p>&#160;</p>  <p><strong>These manual steps can be automated by using the tool: </strong><a href="http://dbe.codeplex.com/"><strong>http://dbe.codeplex.com/</strong></a><strong> (Word Content Control Toolkit)</strong></p>  <p>This tool was created for Office 2007, but can be used for Office 2010 and Office 2013.</p>