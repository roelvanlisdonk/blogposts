---
ID: 2137
post_title: How to boot from an VHD without host OS
author: Roel van Lisdonk
post_excerpt: ""
layout: post
permalink: >
  https://www.roelvanlisdonk.nl/2011/09/08/boot-from-vhd-without-host-os/
published: true
post_date: 2011-09-08 21:58:46
---
<p>You can format the drive of you’re laptop, copy a VHD file to the laptop, by using the Windows 7 installation DVD and than boot from the VHD file.</p>  <p>The hard drive will contain only one file: C:\VHD\MyVritualMachine.vhd</p>  <p>&#160;</p>  <p>This post is just a summary of the post: <a title="http://www.roelvanlisdonk.nl/?p=1530" href="http://www.roelvanlisdonk.nl/?p=1530">http://www.roelvanlisdonk.nl/?p=1530</a> it will describe the steps, how to copy a working VHD image to an “empty” laptop and boot from the VHD file.</p>  <p>Notes</p>  <p>- VHD should run Windows 2008 R2 or Windows 7</p>  <p>&#160;</p>  <p>1. Boot into you’re VHD on machine A</p>  <p>2. execute C:\Windows\System32\sysprep\sysprep.exe</p>  <p>[Out-of-Box Experience (OOBE) and check the Generalize checkbox]</p>  <p>3. Boot from the Windows 7 DVD on Machine B</p>  <p>4. Run the installation of Windows 7 only to the step where you can format the hard drive</p>  <p>5. Format the hard drive (now 2 partitions will be created, one 100MB and one the rest of you’re hard drive)</p>  <p>6. Press SHIFT F10 to open a command window during installation</p>  <p>7. Edit the boot manager by using the bcdedit.exe tool:</p>  <ul>   <li>     <ul>       <li>         <p>bcdedit /copy {current} /d “<strong>MyMachine Description</strong>”</p>       </li>        <li>         <p>The previous statement returns a GUID like: {aa2e3972-7a31-11df-987b-b52175dc348f}</p>       </li>        <li>         <p>bcdedit /set {aa2e3972-7a31-11df-987b-b52175dc348f} device vhd=[C:]\VHD\MyVritualMachine.vhd </p>       </li>        <li>         <p>bcdedit /set {aa2e3972-7a31-11df-987b-b52175dc348f} osdevice vhd=[C:]\VHD\MyVritualMachine.vhd</p>       </li>        <li>         <p>bcdedit /set {aa2e3972-7a31-11df-987b-b52175dc348f} detecthal on</p>       </li>        <li>         <p>bcdedit /set hypervisorlaunchtype auto</p>       </li>        <li>         <p>The previous statement is only needed when the virtual machine is running Microsoft Windows 2008 R2 with the hyper-v role enabled.</p>       </li>     </ul>   </li>    <li>     <p>Reboot Machine B</p>   </li>    <li>     <p>After rebooting you should see two entries one with the description “Windows 7” and an other with the description “<strong>MyMachine Description</strong>”</p>   </li> </ul>  <p>If you laptop requires SATA III drivers just copy these drivers to a USB stick, so it can be used in the mini setup run on every syspreped machine.</p>