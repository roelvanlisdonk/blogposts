---
ID: 491
post_title: >
  Import data from Microsoft Office Access
  2007 to Microsoft SQL Server 2008
author: Roel van Lisdonk
post_excerpt: ""
layout: post
permalink: >
  https://www.roelvanlisdonk.nl/2009/05/26/import-data-from-microsoft-office-access-2007-to-microsoft-sql-server-2008/
published: true
post_date: 2009-05-26 09:17:05
---
<p>There are several ways to import data from Microsoft Office Access to Microsoft SQL Server, but I decided to import de data from Microsoft Access into a Microsoft SQL Server table with &quot;the same&quot; columns and types and made all columns nullable to avoid import errors and then created a TSQL script to move the data to the destination table with different columns and types. This was, because I know a lot about Microsoft SQL Server and less about Microsoft Access. </p>          <p><strong>Table in Microsoft Access</strong>             <br /><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image6.png"><img style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image-thumb6.png" width="244" height="110" /></a> </p>          <p><strong>Import Table in Microsoft SQL Server</strong>             <br /><span style="color: blue">create table </span>dbo<span style="color: gray">.</span>PostcodeImport             <br /><span style="color: gray">(              <br />&#160;</span>Id <span style="color: blue">int </span><span style="color: gray">not null</span><span style="color: blue">identity</span><span style="color: gray">(</span>1<span style="color: gray">,</span>1<span style="color: gray">)</span><span style="color: blue">primary key</span><span style="color: gray">,              <br />&#160;</span>Postcode <span style="color: blue">varchar</span><span style="color: gray">(</span>6<span style="color: gray">) null,              <br />&#160;</span>Series <span style="color: blue">varchar</span><span style="color: gray">(</span>1<span style="color: gray">) null,              <br />&#160;</span>[Huisnummer van] <span style="color: blue">int</span><span style="color: gray">,              <br />&#160;</span>[Huisnummer t/m] <span style="color: blue">int</span><span style="color: gray">,              <br />&#160;</span>Plaats <span style="color: blue">varchar</span><span style="color: gray">(</span>24<span style="color: gray">) null,              <br />&#160;</span>Straat <span style="color: blue">varchar</span><span style="color: gray">(</span>28<span style="color: gray">) null              <br />)               <br /></span><span style="color: blue">go</span></p>          <p><a href="http://11011.net/software/vspaste" jquery1243322945332="5"></a><a href="http://11011.net/software/vspaste" jquery1243322945332="6"></a></p>          <p><strong>To import the data in the &quot;PostcodeImport&quot; table:              <br /></strong>&gt; Open Microsoft SQL Server 2008 Management Studio             <br />&gt; Right click you&#8217;re database &gt; Tasks &gt; Import Data &#8230;             <br />&gt; On SQL Server Import and Export Wizard screen 1 click Next             <br />&gt; On SQL Server Import and Export Wizard screen 2 choose Data source: Microsoft Access             <br />&#160;&#160;&#160; Then click on Browse to select the Microsoft Access file             <br /><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image7.png"><img style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image-thumb7.png" width="241" height="244" /></a>             <br />&gt; On SQL Server Import and Export Wizard screen 3 choose Destination: SQL Server native Client 10.0, the enter you&#8217;re SQL Server name.             <br />&gt; Enter the database name             <br /><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image8.png"><img style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image-thumb8.png" width="238" height="244" /></a>             <br />&gt; On SQL Server Import and Export Wizard screen 4 choose &quot;Copy data from one or more tables or views&quot;             <br />&gt; On SQL Server Import and Export Wizard screen 5 choose Source table &quot;Postcode&quot; and destination table &quot;PostcodeImport&quot;             <br /><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image9.png"><img style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image-thumb9.png" width="238" height="244" /></a>             <br />&gt; We don&#8217;t have to edit the column mappings, because the columns have the same names and types             <br />&gt; Click on Next             <br />&gt; On SQL Server Import and Export Wizard screen 6 click Next             <br />&gt; On SQL Server Import and Export Wizard screen 7 click Next             <br />&gt; On SQL Server Import and Export Wizard screen 8 click Finish             <br /><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image10.png"><img style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2009/05/image-thumb10.png" width="240" height="244" /></a>&#160; <br />&gt; Click on Close </p>          <p>Use a TSQL script to move the data from the PostcodeImport table to the Postcode table            <br /><span style="color: blue">             <br />insert into</span>Postcode <span style="color: gray">(</span>Postcode<span style="color: gray">,</span>Straatnaam<span style="color: gray">,</span>Plaats<span style="color: gray">,</span>RangeStart<span style="color: gray">,</span>RangeEind<span style="color: gray">,</span>PostcodetypeId<span style="color: gray">)              <br /></span><span style="color: blue">select distinct </span>p<span style="color: gray">.</span>Postcode<span style="color: gray">,</span>p<span style="color: gray">.</span>Straat<span style="color: gray">,</span>p<span style="color: gray">.</span>Plaats<span style="color: gray">,</span>p<span style="color: gray">.</span>[Huisnummer van]<span style="color: gray">,</span>p<span style="color: gray">.</span>[Huisnummer t/m]<span style="color: gray">,              <br /></span><span style="color: magenta">cast </span><span style="color: gray">(              <br />&#160;&#160; </span><span style="color: blue">case              <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; when </span>p<span style="color: gray">.</span>Series <span style="color: gray">=</span><span style="color: red">&#8216; &#8216; </span><span style="color: blue">then</span><span style="color: gray">-</span>1             <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">when </span>p<span style="color: gray">.</span>Series <span style="color: gray">is null </span><span style="color: blue">then</span><span style="color: gray">-</span>1             <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">when </span>p<span style="color: gray">.</span>Series <span style="color: gray">=</span><span style="color: red">&#8221; </span><span style="color: blue">then</span><span style="color: gray">-</span>1             <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">else </span>p<span style="color: gray">.</span>Series             <br />&#160;&#160;&#160; <span style="color: blue">end              <br />as int </span><span style="color: gray">)              <br /></span><span style="color: blue">from </span>PostcodeImport p</p>