---
ID: 2896
post_title: 'How to restore a database on a Microsoft SQL Server LocalDb instance, based on a *.bak file.'
author: Roel van Lisdonk
post_excerpt: ""
layout: post
permalink: >
  https://www.roelvanlisdonk.nl/2012/10/17/how-to-restore-a-database-on-a-microsoft-sql-server-localdb-instance-based-on-a-bak-file/
published: true
post_date: 2012-10-17 16:01:01
---
<p>Input</p>  <p>The backup file is located at [C:\Temp\Research.bak]</p>  <p>The folder [C:\Databases] will contain all LocalDb database data (*.mdf) and log (*.ldf) files.</p>  <p>&#160;</p>  <p><strong>Open Microsoft SQL Server 2012 Management Studio</strong></p>  <p>Connect to the LocalDb instance [(localdb)\V11.0]</p>  <p><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image11.png" rel="lightbox"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px 5px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image_thumb11.png" width="434" height="319" /></a></p>  <p>&#160;</p>  <p>Create a empty database with the name [Research]</p>  <p align="left">By default you will get the error:</p>  <p align="left"><font size="1"> [<strong>Create failed for Database 'Research'. (Microsoft.SqlServer.Smo)</strong>]</font></p>  <p align="left"><font size="1"></font></p>  <p align="left"><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image12.png" rel="lightbox"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px 5px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image_thumb12.png" width="580" height="273" /></a></p>  <p align="left">&#160;</p>  <p align="left">Add the following registry keys:</p>  <p align="left"><font size="1">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL11E.LOCALDB\MSSQLServer\DefaultData</font></p>  <p align="left">and</p>  <p align="left"><font size="1">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL11E.LOCALDB\MSSQLServer\DefaultLog</font></p>  <p align="left"><font size="1">and</font></p>  <p align="left"><font size="1">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL11E.LOCALDB\MSSQLServer\BackupDirectory</font></p>  <p align="left">With the values [C:\Databases]</p>  <p align="left"><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image13.png" rel="lightbox"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image_thumb13.png" width="580" height="275" /></a></p>  <p align="left">&#160;</p>  <p align="left">If you donâ€™t add the [BackupDirectory] key, then you will get the error:</p>  <p align="left"><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image14.png" rel="lightbox"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px 5px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image_thumb14.png" width="580" height="146" /></a></p>  <p>&#160;</p>  <p align="left"><strong>Property BackupDirectory is not available for Settings 'Microsoft.SqlServer.Management.Smo.Settings'. This property may not exist for this object, or may not be retrievable due to insufficient access rights.&#160; (Microsoft.SqlServer.Smo)</strong></p>  <p align="left">&#160;</p>  <p align="left"><strong>Double check</strong></p>  <p align="left">Control the values by right clicking on the [(localdb)\V11.0] instance name in the Microsoft SQL Server Management Studio and click on propeties. In the properties dialog click Database Settings:</p>  <p align="left"><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image15.png" rel="lightbox"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px 5px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image_thumb15.png" width="579" height="668" /></a></p>  <p align="left">&#160;</p>  <p align="left">Now you are able to create a new database with the name [Research]. The data and log files will be created in [C:\Databases].</p>  <p align="left"><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image16.png" rel="lightbox"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px 5px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image_thumb16.png" width="444" height="316" /></a></p>  <p align="left">&#160;</p>  <p align="left">Now you are able to restore the database:</p>  <p align="left">&#160;</p>  <p align="left"><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image17.png" rel="lightbox"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px 5px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image_thumb17.png" width="580" height="410" /></a></p>  <p align="left">&#160;</p>  <p align="left"><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image20.png" rel="lightbox"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px 5px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image_thumb20.png" width="580" height="494" /></a></p>  <p align="left">&#160;</p>  <p align="left"><strong>Make sure you check the [Overwrite the existing database (WITH REPLACE)] option]</strong>:</p>  <p align="left">&#160;</p>  <p align="left"><a href="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image19.png" rel="lightbox"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px 5px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://www.roelvanlisdonk.nl/wp-content/uploads/2012/10/image_thumb19.png" width="580" height="498" /></a></p>  <p align="left">&#160;</p>  <p align="left">else you get the error:</p>  <p align="left"><strong>Restore of database 'Research' failed. (Microsoft.SqlServer.Management.RelationalEngineTasks)</strong></p>