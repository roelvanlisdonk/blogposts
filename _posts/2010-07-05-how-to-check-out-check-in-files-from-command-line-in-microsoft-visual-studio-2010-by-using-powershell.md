---
ID: 1586
post_title: 'How to check out &ndash; check in files from command line in Microsoft Visual Studio 2010 by using PowerShell'
author: Roel van Lisdonk
post_excerpt: ""
layout: post
permalink: >
  https://www.roelvanlisdonk.nl/2010/07/05/how-to-check-out-check-in-files-from-command-line-in-microsoft-visual-studio-2010-by-using-powershell/
published: true
post_date: 2010-07-05 14:25:19
---
<p>I have a Microsoft Visual Studio 2010 solution that contains a .net logging component and a customer solution that uses this .net logging component. When I fix a bug in the .net logging component I use a PowerShell script to automatically update the .net logging component in the customer solution:   <br />    <br />    <br /></p>  <p>&#160;</p>  <p>&quot;Settings&quot;   <br />$vsPath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = &quot;C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\{0}&quot;    <br />$devEnvPath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = [string]::Format($vsPath, &quot;devenv.exe&quot;)    <br />$tfPath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = [string]::Format($vsPath, &quot;tf.exe&quot;)    <br />$rebuildLoggingSolution&#160;&#160;&#160;&#160; = $true    <br />$checkOutFiles&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = $true    <br />$copyFiles&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = $true    <br />$rebuildCustomerSolution&#160;&#160;&#160; = $true    <br />$checkInFiles&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = $true    <br />$files&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = @(&quot;LoggingComponent.BC.dll&quot;,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;LoggingComponent.BE.dll&quot;    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ) </p>  <p>&quot;Settings Logging Component Solution&quot;   <br />$lcPath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = &quot;C:\Projects\LC\Main\{0}&quot;    <br />$lcSolutionPath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = [string]::Format($lcPath, &quot;Main.sln&quot;)    <br />$lcReleasePath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = [string]::Format($lcPath, &quot;Source\LC\bin\Release\{0}&quot;) </p>  <p>&quot;Settings Customer Solution&quot;   <br />$cPath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = &quot;C:\Projects\Customer\Main\{0}&quot;    <br />$cSolutionPath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = [string]::Format($lpPath, &quot;Main.sln&quot;)    <br />$cSharedBinariesPath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = [string]::Format($lpPath, &quot;Shared Binaries\{0}&quot;) </p>  <p>if($rebuildLoggingSolution)   <br />{    <br />&#160;&#160;&#160; $parameters = &quot;&quot;&quot;$lcPath&quot;&quot; /rebuild Release&quot;    <br />&#160;&#160;&#160; &quot;Process to start [$devEnvPath $parameters]&quot;     <br />&#160;&#160;&#160; $process = [System.Diagnostics.Process]::Start( &quot;$devEnvPath&quot;, $parameters )     <br />&#160;&#160;&#160; $process.WaitForExit()    <br />} </p>  <p>if($checkOutFiles)   <br />{&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; foreach($file in $files)    <br />&#160;&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $path = [string]::Format($cSharedBinariesPath, $file)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $parameters = &quot;checkout &quot;&quot;$path&quot;&quot;&quot;    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Process to start [$tfPath $parameters]&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $process = [System.Diagnostics.Process]::Start( &quot;$tfPath&quot;, $parameters )     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $process.WaitForExit()    <br />&#160;&#160;&#160; }    <br />} </p>  <p>if($copyFiles)   <br />{    <br />&#160;&#160;&#160; foreach($file in $files)    <br />&#160;&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $source = [string]::Format($lcReleasePath, $file)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $destination = [string]::Format($cSharedBinariesPath, “”)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Copy-Item &quot;$source&quot; -Destination &quot;$destination&quot; -Force    <br />&#160;&#160;&#160; }    <br />} </p>  <p>if($rebuildLocatiePlatform)   <br />{    <br />&#160;&#160;&#160; $parameters = &quot;&quot;&quot;$lpSolutionPath&quot;&quot; /rebuild Release&quot;    <br />&#160;&#160;&#160; &quot;Process to start [$devEnvPath $parameters]&quot;     <br />&#160;&#160;&#160; $process = [System.Diagnostics.Process]::Start( &quot;$devEnvPath&quot;, $parameters )     <br />&#160;&#160;&#160; $process.WaitForExit()    <br />} </p>  <p>if($checkInFiles)   <br />{    <br />&#160;&#160;&#160; foreach($file in $files)    <br />&#160;&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $path = [string]::Format($cSharedBinariesPath, $file)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $parameters = &quot;checkin &quot;&quot;$path&quot;&quot; /noprompt&quot;    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Process to start [$tfPath $parameters]&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $process = [System.Diagnostics.Process]::Start( &quot;$tfPath&quot;, $parameters )     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; $process.WaitForExit()    <br />&#160;&#160;&#160; }    <br />} </p>